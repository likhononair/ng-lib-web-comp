<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Hello World Web Component Demo</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 {
      color: #333;
    }
    .demo-section {
      margin: 20px 0;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .controls {
      margin-top: 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .controls button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      background: #4a5568;
      color: white;
      cursor: pointer;
    }
    .controls input {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      width: 100px;
    }
    .event-log {
      margin-top: 20px;
      padding: 10px;
      background: #1a202c;
      color: #68d391;
      border-radius: 6px;
      font-family: monospace;
      font-size: 0.85rem;
      max-height: 200px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <h1>Hello World Web Component Demo</h1>

  <div class="demo-section">
    <h2>Web Component with Default Settings</h2>
    <hello-world-element id="component1"></hello-world-element>
  </div>

  <div class="demo-section">
    <h2>Web Component with Custom Settings</h2>
    <hello-world-element
      id="component2"
      title="Custom Counter"
      message="This component has custom min/max values"
      initial-value="10"
      min-value="0"
      max-value="50"
      step="5">
    </hello-world-element>
  </div>

  <div class="demo-section">
    <h2>External Controls</h2>
    <p>Control the first component from outside:</p>
    <div class="controls">
      <input type="number" id="externalValue" value="42" placeholder="Value">
      <button onclick="setExternalValue()">Set Counter Value</button>
      <button onclick="getComponentValue()">Get Counter Value</button>
    </div>
    <div class="event-log" id="eventLog">
      <div>Event log will appear here...</div>
    </div>
  </div>

  <script>
    // Wait for custom elements to be defined
    customElements.whenDefined('hello-world-element').then(() => {
      console.log('Web component is ready!');

      // Get references to components
      const component1 = document.getElementById('component1');
      const component2 = document.getElementById('component2');
      const eventLog = document.getElementById('eventLog');

      // Helper to log events
      function logEvent(message) {
        const timestamp = new Date().toLocaleTimeString();
        const entry = document.createElement('div');
        entry.textContent = `[${timestamp}] ${message}`;
        eventLog.appendChild(entry);
        eventLog.scrollTop = eventLog.scrollHeight;
      }

      // Listen for custom events
      component1.addEventListener('actionTriggered', (event) => {
        logEvent(`Action: ${event.detail.type}, Value: ${event.detail.value}`);
      });

      component1.addEventListener('counterChanged', (event) => {
        logEvent(`Counter changed to: ${event.detail}`);
      });

      component2.addEventListener('actionTriggered', (event) => {
        logEvent(`[Component2] Action: ${event.detail.type}, Value: ${event.detail.value}`);
      });

      // Make functions available globally
      window.setExternalValue = function() {
        const input = document.getElementById('externalValue');
        const value = parseInt(input.value, 10);
        if (!isNaN(value)) {
          // Access the Angular component instance method through the web component
          const ngElement = component1;
          if (ngElement.setCounter) {
            ngElement.setCounter(value);
            logEvent(`Set counter externally to: ${value}`);
          } else {
            // Fallback: set attribute
            ngElement.setAttribute('initial-value', value.toString());
            logEvent(`Set initial-value attribute to: ${value}`);
          }
        }
      };

      window.getComponentValue = function() {
        const ngElement = component1;
        if (ngElement.getCounter) {
          const value = ngElement.getCounter();
          logEvent(`Current counter value: ${value}`);
          alert(`Current counter value: ${value}`);
        }
      };

      logEvent('Web component demo initialized');
    });
  </script>
</body>
</html>
